var session_fetch=(function(f,h,a){var c=0.4;var j={use_html5_location:false,ipinfodb_key:false,gapi_location:true,location_cookie:"location",location_cookie_timeout:5,session_timeout:32,session_cookie:"first_session",get_object:null,set_object:null};var g=function(){f.session=f.session||{};f.session.contains=function(u){if(typeof(u)==="string"){return(this.indexOf(u)!==-1)}for(var v=0;v<u.length;v++){if(this.indexOf(u[v])!==-1){return true}}return false};if(f.session&&f.session.options){for(var r in f.session.options){j[r]=f.session.options[r]}}var k={api_version:c,locale:b.locale(),current_session:b.session(),original_session:b.session(j.session_cookie,j.session_timeout*24*60*60*1000),browser:b.browser(),plugins:b.plugins(),time:b.time(),device:b.device()};if(j.use_html5_location){k.location=b.html5_location()}else{if(j.ipinfodb_key){k.location=b.ipinfodb_location(j.ipinfodb_key)}else{if(j.gapi_location){k.location=b.gapi_location()}}}if(f.session&&f.session.start){var m=f.session.start}var s=0,p,t,o=function(u){if(u){s--}if(s===0){if(m){m(f.session)}}};f.session={};for(var l in k){p=k[l];if(typeof p==="function"){try{p(function(u){f.session[l]=u;o(true)});s++}catch(q){if(f.console&&typeof(console.log)==="function"){console.log(q);o(true)}}}else{f.session[l]=p}}o()};var e={detect:function(){var k={browser:this.search(this.data.browser),version:this.search(a.userAgent)||this.search(a.appVersion),os:this.search(this.data.os)};if(k.os=="Linux"){var m=["CentOS","Debian","Fedora","Gentoo","Mandriva","Mageia","Red Hat","Slackware","SUSE","Turbolinux","Ubuntu"];for(var l=0;l<m.length;l++){if(a.userAgent.toLowerCase().match(m[l].toLowerCase())){k.distro=m[l];break}}}return k},search:function(p){if(typeof p==="object"){for(var l=0;l<p.length;l++){var m=p[l].string,o=p[l].prop;this.version_string=p[l].versionSearch||p[l].identity;if(m){if(m.indexOf(p[l].subString)!=-1){return p[l].identity}}else{if(o){return p[l].identity}}}}else{var k=p.indexOf(this.version_string);if(k==-1){return}return parseFloat(p.substr(k+this.version_string.length+1))}},data:{browser:[{string:a.userAgent,subString:"Chrome",identity:"Chrome"},{string:a.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:a.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:f.opera,identity:"Opera",versionSearch:"Version"},{string:a.vendor,subString:"iCab",identity:"iCab"},{string:a.vendor,subString:"KDE",identity:"Konqueror"},{string:a.userAgent,subString:"Firefox",identity:"Firefox"},{string:a.vendor,subString:"Camino",identity:"Camino"},{string:a.userAgent,subString:"Netscape",identity:"Netscape"},{string:a.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:a.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:a.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],os:[{string:a.platform,subString:"Win",identity:"Windows"},{string:a.platform,subString:"Mac",identity:"Mac"},{string:a.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:a.userAgent,subString:"iPad",identity:"iPad"},{string:a.userAgent,subString:"Android",identity:"Android"},{string:a.platform,subString:"Linux",identity:"Linux"}]}};var b={browser:function(){return e.detect()},time:function(){var l=new Date(),k=new Date();l.setMonth(0);l.setDate(1);k.setMonth(6);k.setDate(1);return({tz_offset:-(new Date().getTimezoneOffset())/60,observes_dst:(l.getTimezoneOffset()!==k.getTimezoneOffset())})},locale:function(){var k=((a.language||a.browserLanguage||a.systemLanguage||a.userLanguage)||"").split("-");if(k.length==2){return{country:k[1].toLowerCase(),lang:k[0].toLowerCase()}}else{if(k){return{lang:k[0].toLowerCase(),country:null}}else{return{lang:null,country:null}}}},device:function(){var m={screen:{width:f.screen.width,height:f.screen.height}};var l,k;try{l=f.innerWidth||h.documentElement.clientWidth||h.body.clientWidth}catch(o){l=0}try{f.innerHeight||h.documentElement.clientHeight||h.body.clientHeight}catch(o){k=0}m.viewport={width:l,height:k};m.is_tablet=!!a.userAgent.match(/(iPad|SCH-I800|xoom|kindle)/i);m.is_phone=!m.is_tablet&&!!a.userAgent.match(/(iPhone|iPod|blackberry|android 0.5|htc|lg|midp|mmp|mobile|nokia|opera mini|palm|pocket|psp|sgh|smartphone|symbian|treo mini|Playstation Portable|SonyEricsson|Samsung|MobileExplorer|PalmSource|Benq|Windows Phone|Windows Mobile|IEMobile|Windows CE|Nintendo Wii)/i);m.is_mobile=m.is_tablet||m.is_phone;return m},plugins:function(){var k=function(m){if(a.plugins){var q,o=0,p=a.plugins.length;for(;o<p;o++){q=a.plugins[o];if(q&&q.name&&q.name.toLowerCase().indexOf(m)!==-1){return true}}return false}return false};var l=function(m){var p=true;for(var o=0;o<m.length;o++){try{var r=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"+m[o]),p=!0}catch(q){}if(p){return true}}return false};return{flash:k("flash")||l([".7",".6",""]),silverlight:k("silverlight"),java:k("java"),quicktime:k("quicktime")}},session:function(k,m){var s=d.get_obj(k);if(s==null){s={visits:1,start:new Date().getTime(),last_visit:new Date().getTime(),url:f.location.href,path:f.location.pathname,referrer:h.referrer,referrer_info:d.parse_url(h.referrer),search:{engine:null,query:null}};var o=[{name:"Google",host:"google",query:"q"},{name:"Bing",host:"bing.com",query:"q"},{name:"Yahoo",host:"search.yahoo",query:"p"},{name:"AOL",host:"search.aol",query:"q"},{name:"Ask",host:"ask.com",query:"q"},{name:"Baidu",host:"baidu.com",query:"wd"}],l=o.length,t,r,q=0,u="q query term p wd query text".split(" ");for(q=0;q<l;q++){t=o[q];if(s.referrer_info.host.indexOf(t.host)!==-1){s.search.engine=t.name;s.search.query=s.referrer_info.query[t.query];s.search.terms=s.search.query?s.search.query.split(" "):null;break}}if(s.search.engine===null&&s.referrer_info.search.length>1){for(q=0;q<u.length;q++){var p=s.referrer_info.query[u[q]];if(p){s.search.engine="Unknown";s.search.query=p;s.search.terms=p.split(" ");break}}}}else{s.prev_visit=s.last_visit;s.last_visit=new Date().getTime();s.visits++;s.time_since_last_visit=s.last_visit-s.prev_visit}d.set_obj(k,s,m);return s},html5_location:function(){return function(k){a.geolocation.getCurrentPosition(function(l){l.source="html5";k(l)},function(l){if(j.gapi_location){b.gapi_location()(k)}else{k({error:true,source:"html5"})}})}},gapi_location:function(){return function(l){var k=d.get_obj(j.location_cookie);if(!k||k.source!=="google"){f.gloader_ready=function(){if("google" in f){if(f.google.loader.ClientLocation){f.google.loader.ClientLocation.source="google";l(f.google.loader.ClientLocation)}else{l({error:true,source:"google"})}d.set_obj(j.location_cookie,f.google.loader.ClientLocation,j.location_cookie_timeout*60*60*1000)}};d.embed_script("https://www.google.com/jsapi?callback=gloader_ready")}else{l(k)}}},architecture:function(){var k=n.userAgent.match(/x86_64|Win64|WOW64|x86-64|x64\;|AMD64|amd64/)||(n.cpuClass==="x64")?"x64":"x86";return{arch:k,is_x64:k=="x64",is_x86:k=="x68"}},ipinfodb_location:function(k){return function(m){var l=d.get_obj(j.location_cookie);if(!l&&l.source==="ipinfodb"){f.ipinfocb=function(o){if(o.statusCode==="OK"){o.source="ipinfodb";d.set_obj(j.location_cookie,o,j.location_cookie*60*60*1000);m(o)}else{if(j.gapi_location){return b.gapi_location()(m)}else{m({error:true,source:"ipinfodb",message:o.statusMessage})}}};d.embed_script("http://api.ipinfodb.com/v3/ip-city/?key="+k+"&format=json&callback=ipinfocb")}else{m(l)}}}};var d={parse_url:function(q){var k=h.createElement("a"),p={};k.href=q;var s=k.search.substr(1);if(s!=""){var o=s.split("&"),l=0,m=o.length,r;for(;l<m;l++){r=o[l].split("=");if(r.length===2){p[r[0]]=decodeURI(r[1])}}}return{host:k.host,path:k.pathname,protocol:k.protocol,port:k.port===""?80:k.port,search:k.search,query:p}},set_cookie:function(m,o,k,l){if(!m){return null}if(!l){l={}}if(o===null||o===undefined){k=-1}if(k){l.expires=(new Date().getTime())+k}return(h.cookie=[encodeURIComponent(m),"=",encodeURIComponent(String(o)),l.expires?"; expires="+new Date(l.expires).toUTCString():"","; path="+(l.path?l.path:"/"),l.domain?"; domain="+l.domain:"",(f.location&&f.location.protocol==="https:")?"; secure":""].join(""))},get_cookie:function(l,k){return(k=new RegExp("(?:^|; )"+encodeURIComponent(l)+"=([^;]*)").exec(h.cookie))?decodeURIComponent(k[1]):null},embed_script:function(k){var l=h.createElement("script");l.type="text/javascript";l.src=k;h.getElementsByTagName("body")[0].appendChild(l)},package_obj:function(l){if(l){l.version=c;var k=i.stringify(l);delete l.version;return k}},set_obj:function(m,o,k,l){d.set_cookie(m,d.package_obj(o),k,l)},get_obj:function(m){var l;try{l=i.parse(d.get_cookie(m))}catch(k){}if(l&&l.version==c){delete l.version;return l}}};if(j.get_object!=null){d.get_obj=j.get_object}if(j.set_object!=null){d.set_obj=j.set_object}var i={parse:(f.JSON&&f.JSON.parse)||function(k){if(typeof k!=="string"||!k){return null}return(new Function("return "+k))()},stringify:(f.JSON&&f.JSON.stringify)||function(p){var r=typeof p;if(r!=="object"||p===null){if(r==="string"){return'"'+p+'"'}}else{var o,m,q=[],l=(p&&p.constructor===Array);for(o in p){m=p[o];r=typeof m;if(r==="string"){m='"'+m+'"'}else{if(r==="object"&&m!==null){m=this.stringify(m)}}q.push((l?"":'"'+o+'":')+m)}return(l?"[":"{")+q.join(",")+(l?"]":"}")}}};g()});if(typeof(window.exports)==="undefined"){session_fetch(window,document,navigator)}else{window.exports.session=session_fetch};